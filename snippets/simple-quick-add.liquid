{% comment %}
  Simple Quick Add
  - Adds first available variant to cart
  - No modal
  - No JS
{% endcomment %}

{% assign variant = product.selected_or_first_available_variant %}

{% if variant.available %}
  <button
    class="quick-add-simple"
    data-variant-id="{{ variant.id }}"
    aria-label="Add {{ product.title }} to cart"
  >
    <span class="quick-add-simple__icon">
      {{ 'icon-add-to-cart.svg' | inline_asset_content }}
    </span>
    <span class="quick-add-simple__text">Add</span>
  </button>
{% endif %}


<style>
  .product-image-slider {
  position: relative;
}

/* Container */
.quick-add-simple {
  position: absolute;
  bottom: 10px;
  right: 10px;
  z-index: 20;

  display: flex;
  align-items: center;
  gap: 6px;

  background: #fff;
  border: 1px solid #ddd;
  border-radius: 999px;
  padding: 8px 10px;

  cursor: pointer;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;

  transform: translateY(6px);
  transition: opacity .2s ease, transform .2s ease;
}

/* Show on hover */
.product-image-slider:hover .quick-add-simple {
  opacity: 1;
  visibility: visible;
  pointer-events: all;
  transform: translateY(0);
}

/* Icon */
.quick-add-simple__icon svg {
  width: 16px;
  height: 16px;
}

/* Text (Dawn-style expand) */
.quick-add-simple__text {
  font-size: 14px;
  white-space: nowrap;
  max-width: 0;
  overflow: hidden;
  opacity: 0;
  transition: max-width .25s ease, opacity .2s ease;
}

/* Expand text on hover */
.quick-add-simple:hover .quick-add-simple__text {
  max-width: 50px;
  opacity: 1;
}

/* Added state */
.quick-add-simple.added {
  pointer-events: none;
  opacity: 0.6;
}
</style>

<script>
  document.addEventListener('click', async (e) => {
  const btn = e.target.closest('.simple-quick-add');
  if (!btn) return;

  e.preventDefault();

  const variantId = btn.dataset.variantId;

  await fetch('/cart/add.js', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      id: variantId,
      quantity: 1
    })
  });

  btn.classList.add('added');
});
</script>
